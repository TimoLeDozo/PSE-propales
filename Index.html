<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MSI Propales ¬∑ Neural Console</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: dark;
      --gradient-primary: linear-gradient(135deg, #e0a3ff, #ff69b4, #00ffff);
      --color-bg: #04030a;
      --color-surface: rgba(18, 18, 32, 0.72);
      --color-surface-strong: rgba(12, 12, 24, 0.88);
      --color-surface-soft: rgba(255, 255, 255, 0.06);
      --color-border: rgba(255, 255, 255, 0.12);
      --color-border-strong: rgba(0, 255, 255, 0.35);
      --color-text: #f4f2ff;
      --color-text-soft: rgba(244, 242, 255, 0.74);
      --color-text-muted: rgba(244, 242, 255, 0.55);
      --accent-cyan: #00f7ff;
      --accent-pink: #ff69b4;
      --accent-violet: #a675ff;
      --focus-ring: 0 0 0 3px rgba(0, 247, 255, 0.35);
      --transition-base: 0.3s ease;
      --glass-bg: var(--color-surface);
      --glass-border: var(--color-border);
      --glass-shadow: 0 22px 45px rgba(0, 0, 0, 0.38);
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      overflow-x: hidden;
      min-height: 100vh;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      transition: background 0.6s ease;
    }
    a { color: inherit; transition: color var(--transition-base); }
    .neural-background {
      position: fixed;
      inset: 0;
      z-index: -3;
      background: radial-gradient(circle at 15% 85%, rgba(75, 0, 130, 0.7) 0%, transparent 55%),
        radial-gradient(circle at 85% 15%, rgba(139, 37, 99, 0.8) 0%, transparent 55%),
        radial-gradient(circle at 50% 50%, rgba(0, 255, 255, 0.22) 0%, transparent 65%),
        linear-gradient(135deg, #050505 0%, #12051c 50%, #050505 100%);
      animation: backgroundPulse 16s ease-in-out infinite;
    }
    @keyframes backgroundPulse {
      0%, 100% { filter: brightness(0.92) saturate(1.4); }
      40% { filter: brightness(1.04) saturate(1.55) hue-rotate(10deg); }
      70% { filter: brightness(0.98) saturate(1.6) hue-rotate(-8deg); }
    }
    .geometric-shapes {
      position: fixed;
      inset: 0;
      z-index: -2;
      overflow: hidden;
      pointer-events: none;
    }
    .shape {
      position: absolute;
      border: 1px solid rgba(0, 255, 255, 0.25);
      animation: floatShape 22s linear infinite;
      filter: drop-shadow(0 0 18px rgba(224, 163, 255, 0.35));
    }
    .shape:nth-child(1) { width: 110px; height: 110px; left: 8%; animation-delay: -2s; border-radius: 28px; }
    .shape:nth-child(2) { width: 70px; height: 70px; left: 76%; animation-delay: -9s; border-radius: 50%; border-color: rgba(255, 105, 180, 0.35); }
    .shape:nth-child(3) { width: 90px; height: 90px; left: 30%; animation-delay: -13s; transform: rotate(45deg); }
    .shape:nth-child(4) { width: 150px; height: 150px; left: 58%; animation-delay: -18s; clip-path: polygon(50% 0%, 0% 100%, 100% 100%); background: linear-gradient(45deg, rgba(255, 0, 128, 0.12), transparent); }
    @keyframes floatShape {
      from { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      15%, 85% { opacity: 1; }
      to { transform: translateY(-120px) rotate(360deg); opacity: 0; }
    }
    .neural-lines {
      position: fixed;
      inset: 0;
      z-index: -1;
    }
    .neural-line {
      position: absolute;
      left: 0;
      width: 100%;
      height: 1px;
      opacity: 0.25;
      transform-origin: left;
      transition: transform 0.4s ease;
    }
    .neural-line:nth-child(1) { top: 22%; background: linear-gradient(90deg, transparent, #e0a3ff, transparent); }
    .neural-line:nth-child(2) { top: 52%; background: linear-gradient(90deg, transparent, #ff69b4, transparent); }
    .neural-line:nth-child(3) { top: 78%; background: linear-gradient(90deg, transparent, #00ffff, transparent); }
    @keyframes neuralPulse { 0%,100%{opacity:0.25;transform:scaleX(0.5);} 50%{opacity:1;transform:scaleX(1);} }

    header {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: min(1200px, 94vw);
      padding: 18px 30px;
      border-radius: 28px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 30px;
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(26px);
      transition: background var(--transition-base), border-color var(--transition-base), box-shadow var(--transition-base);
      z-index: 200;
    }
    header.scrolled {
      background: var(--color-surface-strong);
      border-color: var(--color-border-strong);
      box-shadow: 0 25px 55px rgba(0, 0, 0, 0.55);
    }
    nav { display: contents; }
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 700;
      letter-spacing: 0.28em;
      font-size: 0.95rem;
      text-decoration: none;
      text-transform: uppercase;
      color: var(--color-text);
      transition: color var(--transition-base), transform var(--transition-base);
    }
    .logo:focus-visible,
    .logo:hover { color: #ffffff; transform: translateY(-1px); }
    .logo-icon {
      width: 46px;
      height: 46px;
      filter: drop-shadow(0 0 12px rgba(224, 163, 255, 0.65));
    }
    .nav-links {
      list-style: none;
      display: flex;
      gap: 10px;
      align-items: center;
      margin-left: auto;
    }
    .nav-links a {
      text-decoration: none;
      padding: 12px 18px;
      border-radius: 18px;
      font-size: 0.92rem;
      color: var(--color-text-soft);
      transition: color var(--transition-base), transform var(--transition-base);
      position: relative;
    }
    .nav-links a::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(224, 163, 255, 0.18), rgba(0, 255, 255, 0.18));
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: -1;
    }
    .nav-links a:hover::after,
    .nav-links a.active::after { opacity: 1; }
    .nav-links a:hover,
    .nav-links a:focus-visible { color: #ffffff; }
    .nav-links a:focus-visible { outline: none; box-shadow: var(--focus-ring); }
    .nav-links a.active { color: #ffffff; }
    .nav-links a.external-link::after { opacity: 0.45; }

    .mobile-menu-toggle {
      display: none;
      flex-direction: column;
      gap: 5px;
      padding: 10px;
      border-radius: 12px;
      background: var(--color-surface-soft);
      border: 1px solid var(--color-border);
      cursor: pointer;
      transition: background var(--transition-base), transform var(--transition-base);
    }
    .mobile-menu-toggle:hover,
    .mobile-menu-toggle:focus-visible { background: rgba(224, 163, 255, 0.2); outline: none; box-shadow: var(--focus-ring); }
    .hamburger-line { width: 24px; height: 2px; background: linear-gradient(90deg, #e0a3ff, #ff69b4); border-radius: 2px; transition: transform 0.3s ease, opacity 0.3s ease; }
    .mobile-menu-toggle.active .hamburger-line:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
    .mobile-menu-toggle.active .hamburger-line:nth-child(2) { opacity: 0; }
    .mobile-menu-toggle.active .hamburger-line:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }
    .mobile-nav {
      position: fixed;
      top: 95px;
      left: 50%;
      transform: translateX(-50%);
      width: min(420px, 90vw);
      padding: 28px;
      border-radius: 24px;
      background: var(--color-surface-strong);
      border: 1px solid var(--color-border);
      box-shadow: 0 25px 55px rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(22px);
      display: none;
      flex-direction: column;
      gap: 18px;
      z-index: 190;
    }
    .mobile-nav a {
      text-decoration: none;
      padding: 14px 18px;
      border-radius: 16px;
      background: var(--color-surface-soft);
      border: 1px solid var(--color-border);
      text-align: center;
      color: var(--color-text);
      transition: background var(--transition-base), color var(--transition-base), transform var(--transition-base);
    }
    .mobile-nav a:hover,
    .mobile-nav a.active { background: rgba(224, 163, 255, 0.15); border-color: rgba(224, 163, 255, 0.4); color: #fff; }
    .mobile-nav.active { display: flex; animation: slideDown 0.28s ease-out; }
    @keyframes slideDown { from { opacity: 0; transform: translate(-50%, -10px); } to { opacity: 1; transform: translate(-50%, 0); } }

    main { position: relative; padding-top: 140px; }
    .hero {
      min-height: 95vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 140px 20px 120px;
      position: relative;
    }
    .hero::before {
      content: '';
      position: absolute;
      inset: 20% 12% 10%;
      background: radial-gradient(circle, rgba(224, 163, 255, 0.1) 0%, transparent 70%);
      z-index: -1;
      animation: heroGlow 12s ease-in-out infinite;
    }
    @keyframes heroGlow { 0%,100%{transform:scale(1);opacity:0.6;} 50%{transform:scale(1.22);opacity:1;} }
    .hero-content { max-width: 960px; margin: 0 auto; }
    .hero-subtitle {
      text-transform: uppercase;
      letter-spacing: 0.5em;
      font-size: 0.75rem;
      color: rgba(224, 163, 255, 0.8);
      margin-bottom: 24px;
    }
    .hero h1 {
      font-size: clamp(2.2rem, 6vw, 4.4rem);
      font-weight: 800;
      background: linear-gradient(135deg, #e0a3ff, #ff69b4, #8ec5ff);
      background-size: 260% 260%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: modernGradient 8s ease infinite;
      margin-bottom: 28px;
    }
    @keyframes modernGradient { 0%{background-position:0% 50%;} 50%{background-position:100% 50%;} 100%{background-position:0% 50%;} }
    .hero-description { max-width: 740px; margin: 0 auto 60px; color: var(--color-text-soft); font-size: 1.05rem; }
    .hero-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 24px; margin: 0 auto 60px; max-width: 800px; }
    .hero-stat { padding: 24px; border-radius: 20px; background: var(--color-surface); border: 1px solid rgba(224, 163, 255, 0.2); box-shadow: 0 20px 45px rgba(0,0,0,0.32); backdrop-filter: blur(16px); transition: transform var(--transition-base), box-shadow var(--transition-base); }
    .hero-stat:hover { transform: translateY(-6px); box-shadow: 0 32px 60px rgba(0,0,0,0.45); }
    .hero-stat-number { font-size: 2.1rem; font-weight: 700; color: #ffffff; margin-bottom: 6px; }
    .hero-stat-label { text-transform: uppercase; font-size: 0.7rem; letter-spacing: 0.2em; color: rgba(255,255,255,0.65); }
    .cta-buttons { display: flex; justify-content: center; gap: 16px; flex-wrap: wrap; }
    .cta-button { display: inline-flex; align-items: center; gap: 10px; padding: 14px 34px; border-radius: 999px; border: none; cursor: pointer; font-weight: 600; text-transform: uppercase; letter-spacing: 0.08em; font-size: 0.85rem; transition: transform var(--transition-base), box-shadow var(--transition-base), background var(--transition-base); text-decoration: none; }
    .cta-button.primary { background: var(--gradient-primary); color: #050505; box-shadow: 0 18px 35px rgba(224, 163, 255, 0.35); }
    .cta-button.secondary { background: var(--color-surface-soft); color: var(--color-text); border: 1px solid var(--color-border); }
    .cta-button:hover,
    .cta-button:focus-visible { transform: translateY(-4px) scale(1.01); outline: none; box-shadow: 0 25px 45px rgba(0,0,0,0.4), var(--focus-ring); }

    .console-section {
      position: relative;
      padding: 160px 20px 140px;
    }
    .console-wrapper {
      width: min(1100px, 94vw);
      margin: 0 auto;
      display: grid;
      gap: 40px;
    }
    .console-layout {
      display: grid;
      gap: 32px;
      align-items: start;
    }
    .results-column {
      display: grid;
      gap: 28px;
      align-content: start;
    }
    .console-header { text-align: center; }
    .console-header h2 { font-size: clamp(2.2rem, 4vw, 3.1rem); margin-bottom: 16px; letter-spacing: -0.01em; }
    .console-header p { color: var(--color-text-soft); max-width: 680px; margin: 0 auto; }
    .form-panels {
      display: grid;
      gap: 32px;
    }
    .glass-panel {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 28px;
      padding: 34px;
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(22px);
      transition: transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-base);
    }
    .glass-panel:hover { transform: translateY(-6px); box-shadow: 0 26px 55px rgba(0,0,0,0.5); border-color: var(--color-border-strong); }
    .panel-title { font-size: 1.3rem; font-weight: 600; margin-bottom: 24px; letter-spacing: 0.04em; display: flex; align-items: center; gap: 10px; color: var(--color-text); }
    .panel-title span:first-child { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; border-radius: 12px; background: rgba(0, 247, 255, 0.12); color: var(--accent-cyan); }
    .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 18px 22px; }
    .field label { display: block; margin-bottom: 8px; font-size: 0.78rem; letter-spacing: 0.14em; color: var(--color-text-muted); text-transform: uppercase; }
    .field input,
    .field textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: rgba(10, 10, 18, 0.78);
      color: var(--color-text);
      font-size: 0.95rem;
      font-weight: 500;
      transition: border var(--transition-base), box-shadow var(--transition-base), background var(--transition-base), transform var(--transition-base);
      resize: vertical;
      min-height: 52px;
    }
    .field textarea { min-height: 120px; }
    .field input:focus,
    .field textarea:focus {
      outline: none;
      border-color: var(--accent-cyan);
      box-shadow: var(--focus-ring);
      background: rgba(12, 12, 22, 0.92);
      transform: translateY(-1px);
    }
    .grid-span-2 { grid-column: span 2; }
    .actions { text-align: center; display: grid; gap: 16px; margin-top: 20px; }
    #btnGenerate { background: var(--gradient-primary); color: #050505; border: none; border-radius: 999px; padding: 18px 34px; font-weight: 700; font-size: 0.95rem; letter-spacing: 0.12em; cursor: pointer; transition: transform var(--transition-base), box-shadow var(--transition-base); box-shadow: 0 22px 50px rgba(0, 0, 0, 0.55); }
    #btnGenerate:hover,
    #btnGenerate:focus-visible { transform: translateY(-5px); box-shadow: 0 32px 60px rgba(0, 0, 0, 0.65), var(--focus-ring); outline: none; }
    .microcopy { font-size: 0.75rem; color: var(--color-text-muted); letter-spacing: 0.1em; text-transform: uppercase; }

    .result-card { display: grid; gap: 20px; }
    .result-status {
      padding: 18px 20px;
      border-radius: 20px;
      background: rgba(0, 0, 0, 0.28);
      border: 1px solid var(--color-border);
      color: var(--color-text);
      font-weight: 500;
      line-height: 1.5;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      transition: transform var(--transition-base), border-color var(--transition-base), background var(--transition-base);
    }
    .result-status span { flex: 1 1 auto; }
    .result-status a { color: #050505; display: inline-flex; align-items: center; gap: 8px; padding: 10px 16px; border-radius: 14px; background: var(--gradient-primary); text-decoration: none; box-shadow: 0 20px 35px rgba(0,0,0,0.45); transition: transform var(--transition-base), box-shadow var(--transition-base); }
    .result-status a:hover,
    .result-status a:focus-visible { transform: translateY(-2px); box-shadow: 0 26px 45px rgba(0,0,0,0.55); outline: none; box-shadow: 0 26px 45px rgba(0,0,0,0.55), var(--focus-ring); }
    .result-status.is-idle { border-color: var(--color-border); background: rgba(255,255,255,0.04); }
    .result-status.is-progress { border-color: rgba(0, 247, 255, 0.45); background: rgba(0, 247, 255, 0.08); }
    .result-status.is-success { border-color: rgba(0, 255, 153, 0.45); background: rgba(0, 255, 153, 0.08); }
    .result-status.is-error { border-color: rgba(255, 105, 180, 0.5); background: rgba(255, 105, 180, 0.1); }
    .result-history { list-style: none; display: grid; gap: 14px; }
    .result-item { display: flex; justify-content: space-between; gap: 18px; align-items: center; padding: 14px 18px; border-radius: 16px; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); color: var(--color-text-soft); font-size: 0.9rem; transition: transform var(--transition-base), border-color var(--transition-base), background var(--transition-base); }
    .result-item time { font-size: 0.75rem; letter-spacing: 0.08em; color: var(--color-text-muted); text-transform: uppercase; }
    .result-item:hover { transform: translateY(-3px); border-color: rgba(0, 247, 255, 0.3); }
    .result-item.is-progress { border-color: rgba(0, 247, 255, 0.3); }
    .result-item.is-success { border-color: rgba(0, 255, 153, 0.35); }
    .result-item.is-error { border-color: rgba(255, 105, 180, 0.35); }
    .tips-panel { padding: 28px; border-radius: 24px; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); display: grid; gap: 16px; transition: transform var(--transition-base), border-color var(--transition-base); }
    .tips-panel:hover { transform: translateY(-6px); border-color: rgba(0, 247, 255, 0.25); }
    .tips-panel h3 { font-size: 1.1rem; color: var(--color-text); }
    .tips-panel ul { list-style: none; display: grid; gap: 10px; color: var(--color-text-muted); font-size: 0.9rem; }
    .tips-panel li { display: flex; align-items: center; gap: 10px; }
    .tips-panel li span { font-size: 1.1rem; }

    .features, .showcase, .timeline, .contact, footer { position: relative; }
    .features { padding: 140px 20px; }
    .features-container { width: min(1100px, 94vw); margin: 0 auto; }
    .section-title { font-size: clamp(2.2rem, 4vw, 3.2rem); text-align: center; margin-bottom: 80px; letter-spacing: 0.02em; }
    .diagonal-grid { display: flex; flex-direction: column; gap: 48px; }
    .feature-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 32px; align-items: stretch; }
    .feature-content { padding: 34px; border-radius: 26px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.14); backdrop-filter: blur(18px); box-shadow: var(--glass-shadow); transform: translateY(0); transition: transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-base); }
    .feature-content:hover { transform: translateY(-10px); box-shadow: 0 32px 60px rgba(0, 0, 0, 0.45); border-color: rgba(0, 247, 255, 0.35); }
    .feature-icon { font-size: 2.8rem; margin-bottom: 20px; }
    .feature-content h3 { font-size: 1.4rem; margin-bottom: 12px; }
    .feature-content p { color: var(--color-text-soft); font-size: 0.98rem; }
    .feature-visual { border-radius: 26px; background: linear-gradient(135deg, rgba(224,163,255,0.14), rgba(0,255,255,0.12)); border: 1px solid rgba(255,255,255,0.12); backdrop-filter: blur(16px); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08); position: relative; overflow: hidden; min-height: 240px; transition: border-color var(--transition-base); }
    .feature-row:hover .feature-visual { border-color: rgba(0, 247, 255, 0.25); }
    .feature-visual::after { content: ''; position: absolute; inset: 25px; border-radius: 22px; border: 1px solid rgba(255,255,255,0.14); opacity: 0.5; }

    .showcase { padding: 140px 20px; }
    .hexagon-container { display: flex; flex-wrap: wrap; gap: 28px; justify-content: center; }
    .hexagon { width: 210px; height: 260px; position: relative; }
    .hexagon-inner { position: absolute; inset: 0; padding: 40px 24px; border-radius: 26px; transform: rotate(30deg); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 16px; text-align: center; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.18); backdrop-filter: blur(18px); transition: transform 0.4s ease, box-shadow 0.4s ease; box-shadow: var(--glass-shadow); }
    .hexagon:hover .hexagon-inner { transform: rotate(0deg); box-shadow: 0 35px 55px rgba(0,0,0,0.45); }
    .hexagon-icon { font-size: 2.6rem; transform: rotate(-30deg); }
    .hexagon h4, .hexagon p { transform: rotate(-30deg); }
    .hexagon h4 { font-size: 1.2rem; }
    .hexagon p { color: var(--color-text-soft); font-size: 0.9rem; }

    .timeline { padding: 140px 20px; }
    .timeline-container { width: min(1100px, 94vw); margin: 0 auto; position: relative; }
    .timeline-line { position: absolute; left: 50%; top: 0; bottom: 0; width: 3px; background: linear-gradient(180deg, #e0a3ff, #ff69b4, #00ffff); opacity: 0.65; }
    .timeline-item { position: relative; display: flex; justify-content: flex-end; padding: 0 50px 60px; }
    .timeline-item:nth-child(even) { justify-content: flex-start; }
    .timeline-dot { position: absolute; left: 50%; top: 20px; transform: translateX(-50%); width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(135deg, #ff69b4, #00ffff); box-shadow: 0 0 28px rgba(0, 255, 255, 0.45); }
    .timeline-content { max-width: 420px; background: var(--color-surface-strong); border: 1px solid rgba(255, 255, 255, 0.12); border-radius: 24px; padding: 34px; box-shadow: var(--glass-shadow); backdrop-filter: blur(20px); transition: transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-base); }
    .timeline-content:hover { transform: translateY(-8px); box-shadow: 0 32px 55px rgba(0, 0, 0, 0.55); border-color: rgba(0, 247, 255, 0.35); }
    .timeline-year { font-size: 1.4rem; letter-spacing: 0.1em; color: rgba(224, 163, 255, 0.9); margin-bottom: 12px; }
    .timeline-content h4 { font-size: 1.25rem; margin-bottom: 12px; }
    .timeline-content p { color: var(--color-text-soft); }

    .contact { padding: 140px 20px; }
    .contact-container { width: min(1100px, 94vw); margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 40px; }
    .contact-info { padding: 40px; border-radius: 28px; background: var(--glass-bg); border: 1px solid var(--glass-border); box-shadow: var(--glass-shadow); backdrop-filter: blur(22px); transition: transform var(--transition-base), border-color var(--transition-base); }
    .contact-info:hover { transform: translateY(-6px); border-color: var(--color-border-strong); }
    .contact-info h3 { font-size: 1.9rem; margin-bottom: 18px; }
    .contact-info p { color: var(--color-text-soft); margin-bottom: 16px; }
    .social-links { display: flex; gap: 18px; margin-top: 30px; }
    .social-links a { width: 54px; height: 54px; border-radius: 16px; display: inline-flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12); color: var(--accent-cyan); font-size: 1.35rem; transition: transform var(--transition-base), box-shadow var(--transition-base), border-color var(--transition-base); }
    .social-links a:hover,
    .social-links a:focus-visible { transform: translateY(-4px) scale(1.05); box-shadow: 0 22px 45px rgba(0, 255, 255, 0.35), var(--focus-ring); border-color: rgba(0, 255, 255, 0.35); outline: none; }
    .contact-form { padding: 40px; border-radius: 28px; background: rgba(12, 12, 22, 0.84); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: var(--glass-shadow); backdrop-filter: blur(18px); display: grid; gap: 18px; transition: transform var(--transition-base), border-color var(--transition-base); }
    .contact-form:hover { transform: translateY(-6px); border-color: rgba(0, 247, 255, 0.35); }
    .contact-form .form-group { display: grid; gap: 10px; }
    .contact-form input, .contact-form textarea { padding: 14px 16px; border-radius: 16px; background: rgba(10, 10, 18, 0.78); border: 1px solid rgba(255, 255, 255, 0.12); color: var(--color-text); font-size: 0.95rem; transition: border var(--transition-base), box-shadow var(--transition-base), background var(--transition-base); }
    .contact-form input:focus,
    .contact-form textarea:focus { outline: none; border-color: var(--accent-cyan); box-shadow: var(--focus-ring); background: rgba(12, 12, 22, 0.92); }
    .submit-btn { padding: 16px; border-radius: 16px; border: none; cursor: pointer; font-weight: 600; letter-spacing: 0.14em; text-transform: uppercase; background: linear-gradient(135deg, #00ffff, #ff0080); color: #050505; transition: transform var(--transition-base), box-shadow var(--transition-base); }
    .submit-btn:hover,
    .submit-btn:focus-visible { transform: translateY(-4px); box-shadow: 0 25px 45px rgba(0, 0, 0, 0.5), var(--focus-ring); outline: none; }

    footer { padding: 80px 20px; background: rgba(0, 0, 0, 0.5); border-top: 1px solid rgba(255, 255, 255, 0.1); }
    .footer-content { width: min(1100px, 94vw); margin: 0 auto; display: grid; gap: 24px; text-align: center; color: var(--color-text-soft); }
    .footer-links { display: flex; flex-wrap: wrap; justify-content: center; gap: 18px; }
    .footer-links a { text-decoration: none; font-size: 0.85rem; color: var(--color-text-muted); transition: color var(--transition-base), transform var(--transition-base); }
    .footer-links a:hover,
    .footer-links a:focus-visible { color: #ffffff; transform: translateY(-2px); outline: none; box-shadow: var(--focus-ring); border-radius: 12px; padding: 4px 10px; }

    #modal {
      position: fixed;
      inset: 0;
      background: rgba(5, 5, 12, 0.65);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 300;
      backdrop-filter: blur(8px);
      padding: 20px;
    }
    #modal.active { display: flex; }
    .modal-card {
      width: min(420px, 92vw);
      background: var(--color-surface-strong);
      border-radius: 28px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.55);
      padding: 32px;
      color: var(--color-text);
      display: grid;
      gap: 18px;
    }
    .modal-progress { width: 100%; height: 10px; border-radius: 999px; background: rgba(255,255,255,0.08); overflow: hidden; }
    .modal-progress-bar { width: 0%; height: 100%; border-radius: 999px; background: linear-gradient(90deg, #00ffff, #ff69b4); transition: width 0.2s ease; }
    .modal-actions { display: flex; justify-content: flex-end; }
    #btnCloseModal { padding: 12px 22px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.16); background: rgba(255,255,255,0.08); color: var(--color-text); font-weight: 500; cursor: pointer; transition: transform var(--transition-base), background var(--transition-base), box-shadow var(--transition-base); display: none; }
    #btnCloseModal:hover,
    #btnCloseModal:focus-visible { background: rgba(224,163,255,0.25); transform: translateY(-2px); box-shadow: var(--focus-ring); outline: none; }
    .modal-result a { display: inline-flex; align-items: center; justify-content: center; padding: 12px 20px; border-radius: 16px; background: linear-gradient(135deg, #6a5bff, #00ffff); color: #050505; font-weight: 600; text-decoration: none; margin-top: 10px; transition: transform var(--transition-base), box-shadow var(--transition-base); }
    .modal-result a:hover,
    .modal-result a:focus-visible { transform: translateY(-2px); box-shadow: 0 26px 45px rgba(0,0,0,0.55); outline: none; box-shadow: 0 26px 45px rgba(0,0,0,0.55), var(--focus-ring); }

    @media (min-width: 1100px) {
      .console-layout { grid-template-columns: minmax(0, 1.7fr) minmax(0, 1fr); }
      .results-column { position: sticky; top: 140px; }
    }
    @media (max-width: 900px) {
      .console-layout { gap: 28px; }
      .results-column { order: 2; }
    }
    @media (max-width: 620px) {
      .result-item { flex-direction: column; align-items: flex-start; gap: 8px; }
    }
    @media (max-width: 1000px) {
      .nav-links { display: none; }
      .mobile-menu-toggle { display: flex; }
    }
    @media (max-width: 768px) {
      header { padding: 14px 20px; }
      .hero { padding-top: 160px; }
      .hero h1 { font-size: clamp(2rem, 8vw, 3.4rem); }
      .hero-stats { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .form-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
      .grid-span-2 { grid-column: span 1; }
      .timeline-line { left: 24px; }
      .timeline-item { justify-content: flex-start; padding-left: 70px; }
      .timeline-item:nth-child(even) { justify-content: flex-start; }
      .timeline-dot { left: 24px; }
    }
    @media (max-width: 540px) {
      header { width: 96vw; }
      .console-wrapper { gap: 28px; }
      .glass-panel { padding: 26px; }
      .contact-form, .contact-info { padding: 30px; }
      .hexagon { width: 240px; height: 300px; }
    }
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; }
    }
    ::-webkit-scrollbar { width: 12px; }
    ::-webkit-scrollbar-track { background: rgba(8, 8, 8, 0.85); }
    ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #00ffff, #ff0080); border-radius: 6px; }
  </style>
</head>
<body>
  <div class="neural-background"></div>
  <div class="geometric-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
  </div>
  <div class="neural-lines">
    <div class="neural-line"></div>
    <div class="neural-line"></div>
    <div class="neural-line"></div>
  </div>

  <header class="glass">
    <nav>
      <a href="#home" class="logo">
        <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#e0a3ff" />
              <stop offset="50%" style="stop-color:#ff69b4" />
              <stop offset="100%" style="stop-color:#9370db" />
            </linearGradient>
          </defs>
          <circle cx="50" cy="30" r="8" fill="url(#logoGradient)" opacity="0.8">
            <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" repeatCount="indefinite" />
          </circle>
          <circle cx="30" cy="60" r="6" fill="url(#logoGradient)" opacity="0.6">
            <animate attributeName="opacity" values="0.6;1;0.6" dur="2.5s" repeatCount="indefinite" />
          </circle>
          <circle cx="70" cy="65" r="7" fill="url(#logoGradient)" opacity="0.7">
            <animate attributeName="opacity" values="0.7;1;0.7" dur="1.8s" repeatCount="indefinite" />
          </circle>
          <line x1="50" y1="30" x2="30" y2="60" stroke="url(#logoGradient)" stroke-width="2" opacity="0.6">
            <animate attributeName="opacity" values="0.6;1;0.6" dur="3s" repeatCount="indefinite" />
          </line>
          <line x1="50" y1="30" x2="70" y2="65" stroke="url(#logoGradient)" stroke-width="2" opacity="0.6">
            <animate attributeName="opacity" values="0.6;1;0.6" dur="2.2s" repeatCount="indefinite" />
          </line>
          <line x1="30" y1="60" x2="70" y2="65" stroke="url(#logoGradient)" stroke-width="2" opacity="0.6">
            <animate attributeName="opacity" values="0.6;1;0.6" dur="2.8s" repeatCount="indefinite" />
          </line>
        </svg>
        NeuralGlass
      </a>
      <ul class="nav-links">
        <li><a href="#console" class="active">Console</a></li>
        <li><a href="#features">Neural</a></li>
        <li><a href="#showcase">Matrix</a></li>
        <li><a href="#timeline">Evolution</a></li>
        <li><a href="#contact">Connect</a></li>
        <li><a href="https://github.com" target="_blank" class="external-link" rel="noopener">GitHub</a></li>
      </ul>
      <div class="mobile-menu-toggle" aria-label="Menu">
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
      </div>
    </nav>
    <div class="mobile-nav">
      <a href="#console" class="active">Console</a>
      <a href="#features">Neural</a>
      <a href="#showcase">Matrix</a>
      <a href="#timeline">Evolution</a>
      <a href="#contact">Connect</a>
      <a href="https://github.com" target="_blank" class="external-link" rel="noopener">GitHub</a>
    </div>
  </header>

  <main>
    <section class="hero" id="home">
      <div class="hero-content">
        <div class="hero-subtitle">Propales instantan√©es</div>
        <h1>NEURAL PROPAL ENGINE</h1>
        <div class="hero-description">
          <p>Fusionnez la rigueur Icam avec une interface Apple-like et l'√©nergie cyberpunk de NeuralGlass. Alimentez DeepSeek, d√©clenchez la duplication Drive et produisez vos propositions en un √©clair, sans compromis sur l'√©l√©gance.</p>
        </div>
        <div class="hero-stats">
          <div class="hero-stat">
            <span class="hero-stat-number">60s</span>
            <span class="hero-stat-label">Document pr√™t</span>
          </div>
          <div class="hero-stat">
            <span class="hero-stat-number">100%</span>
            <span class="hero-stat-label">Color mapping</span>
          </div>
          <div class="hero-stat">
            <span class="hero-stat-number">‚àû</span>
            <span class="hero-stat-label">DeepSeek Access</span>
          </div>
          <div class="hero-stat">
            <span class="hero-stat-number">1</span>
            <span class="hero-stat-label">Clic n√©cessaire</span>
          </div>
        </div>
        <div class="cta-buttons">
          <a href="#console" class="cta-button primary">Initier la console</a>
          <a href="#features" class="cta-button secondary">D√©couvrir les flux</a>
        </div>
      </div>
    </section>

    <section class="console-section" id="console">
      <div class="console-wrapper">
        <div class="console-header">
          <h2>Console Neural ¬∑ G√©n√©ration de propale</h2>
          <p>Renseignez les zones cl√©s. Toutes les informations sont transmises √† Apps Script qui orchestre la copie du template Google Docs, le remplissage des zones surlign√©es et l'appel √† DeepSeek.</p>
        </div>
        <div class="console-layout">
          <div class="form-panels">
            <div class="glass-panel">
              <div class="panel-title"><span aria-hidden="true">üìã</span><span>Informations projet</span></div>
            <div class="form-grid">
              <div class="field grid-span-2"><label for="f_titre">Titre *</label><input id="f_titre" type="text" placeholder="Optimisation flux entrep√¥t" required></div>
              <div class="field"><label for="f_codeProjet">Code projet</label><input id="f_codeProjet" type="text" placeholder="144-16"></div>
              <div class="field"><label for="f_dateDebut">Date d√©but</label><input id="f_dateDebut" type="date"></div>
              <div class="field"><label for="f_versionDoc">Version</label><input id="f_versionDoc" type="text" placeholder="V1"></div>
              <div class="field"><label for="f_dureeProjet">Dur√©e</label><input id="f_dureeProjet" type="text" placeholder="6 mois"></div>
              <div class="field"><label for="f_thematique">Th√©matique</label><input id="f_thematique" type="text" placeholder="Logistique / Supply-chain"></div>
            </div>
          </div>
            <div class="glass-panel">
              <div class="panel-title"><span aria-hidden="true">üè¢</span><span>Entreprise &amp; Contact</span></div>
            <div class="form-grid">
              <div class="field"><label for="f_entrepriseNom">Entreprise *</label><input id="f_entrepriseNom" type="text" placeholder="Velibor SA" required></div>
              <div class="field"><label for="f_entrepriseAdresse">Adresse</label><input id="f_entrepriseAdresse" type="text" placeholder="49 bis rue Sedaine, 75011 Paris"></div>
              <div class="field"><label for="f_clientNom">Nom contact</label><input id="f_clientNom" type="text" placeholder="Jean Dupont"></div>
              <div class="field"><label for="f_clientFonction">Fonction</label><input id="f_clientFonction" type="text" placeholder="Directeur Technique"></div>
              <div class="field"><label for="f_clientEmail">Email</label><input id="f_clientEmail" type="email" placeholder="jean@exemple.com"></div>
              <div class="field"><label for="f_clientTelephone">T√©l√©phone</label><input id="f_clientTelephone" type="tel" placeholder="01 23 45 67 89"></div>
              <div class="field grid-span-2"><label for="f_entrepriseLogo">Logo (URL image https://‚Ä¶)</label><input id="f_entrepriseLogo" type="url" placeholder="https://..." ></div>
            </div>
          </div>
            <div class="glass-panel">
              <div class="panel-title"><span aria-hidden="true">ü§ñ</span><span>Sections g√©n√©r√©es par DeepSeek</span></div>
            <div class="form-grid">
              <div class="field grid-span-2"><label for="f_contexte">Contexte</label><textarea id="f_contexte" placeholder="(G√©n√©r√© / Edition manuelle possible)"></textarea></div>
              <div class="field grid-span-2"><label for="f_demarche">D√©marche</label><textarea id="f_demarche" placeholder="(G√©n√©r√© / Edition manuelle possible)"></textarea></div>
              <div class="field grid-span-2"><label for="f_phases">Phases</label><textarea id="f_phases" placeholder="(G√©n√©r√© / Edition manuelle possible)"></textarea></div>
              <div class="field grid-span-2"><label for="f_phrase">Phrase de cl√¥ture</label><textarea id="f_phrase" rows="2" placeholder="(G√©n√©r√© / Edition manuelle possible)"></textarea></div>
            </div>
            <div class="actions">
              <button id="btnGenerate">‚ú® G√©n√©rer la propale</button>
              <p class="microcopy">Uniquement Color-Mapping ¬∑ Aucun placeholder [[‚Ä¶]]</p>
            </div>
          </div>
          </div>
          <aside class="results-column" aria-label="Historique de g√©n√©ration">
            <div class="glass-panel result-card">
              <div class="panel-title"><span aria-hidden="true">üìÑ</span><span>Statut de g√©n√©ration</span></div>
              <p id="resultStatus" class="result-status is-idle" aria-live="polite">Aucun document g√©n√©r√© pour le moment.</p>
              <ul id="resultHistory" class="result-history" aria-live="polite" aria-label="Derniers √©v√®nements">
                <li class="result-item" data-placeholder="true"><span>En attente de lancement.</span><time aria-hidden="true">‚Äî</time></li>
              </ul>
            </div>
            <div class="tips-panel">
              <h3>Conseils express</h3>
              <ul>
                <li><span aria-hidden="true">üñãÔ∏è</span>Pr√©-remplissez les champs obligatoires avant DeepSeek.</li>
                <li><span aria-hidden="true">üéØ</span>Utilisez une URL https valide pour le logo afin d'√©viter les erreurs.</li>
                <li><span aria-hidden="true">üõ∞Ô∏è</span>Rev√©rifiez les informations client avant l'envoi Apps Script.</li>
              </ul>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <section class="features" id="features">
      <div class="features-container">
        <h2 class="section-title">Quantum Capabilities</h2>
        <div class="diagonal-grid">
          <div class="feature-row">
            <div class="feature-content">
              <div class="feature-icon">üß†</div>
              <h3>Neural Processing</h3>
              <p>Le moteur Apps Script capte vos donn√©es, mappe automatiquement les zones color√©es du template Google Docs et garantit une coh√©rence parfaite entre client, entreprise et contacts.</p>
            </div>
            <div class="feature-visual"></div>
          </div>
          <div class="feature-row">
            <div class="feature-content">
              <div class="feature-icon">‚ö°</div>
              <h3>Quantum Speed</h3>
              <p>Le backend orchestre la copie du mod√®le, l'appel DeepSeek et l'enregistrement dans le Drive cible. Temps de r√©ponse optimis√© et journalisation automatique des co√ªts.</p>
            </div>
            <div class="feature-visual"></div>
          </div>
          <div class="feature-row">
            <div class="feature-content">
              <div class="feature-icon">üåê</div>
              <h3>Dimensional Sync</h3>
              <p>Gestion intelligente des doublons, nettoyage du surlignage et int√©gration transparente du logo entreprise gr√¢ce au cache base64 embarqu√© c√¥t√© serveur.</p>
            </div>
            <div class="feature-visual"></div>
          </div>
        </div>
      </div>
    </section>

    <section class="showcase" id="showcase">
      <h2 class="section-title">Matrix Protocols</h2>
      <div class="hexagon-container">
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">üîÆ</div><h4>Holographic UI</h4><p>Interface monofichier pr√™te pour Apps Script</p></div></div>
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">üõ°Ô∏è</div><h4>Quantum Security</h4><p>Cl√© DeepSeek stock√©e c√¥t√© serveur</p></div></div>
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">üöÄ</div><h4>Warp Navigation</h4><p>Acc√®s direct au document g√©n√©r√©</p></div></div>
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">üíé</div><h4>Crystal Storage</h4><p>Copie organis√©e dans Drive cible</p></div></div>
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">üéØ</div><h4>Neural Targeting</h4><p>Color mapping intelligent</p></div></div>
        <div class="hexagon"><div class="hexagon-inner"><div class="hexagon-icon">‚≠ê</div><h4>Stellar Network</h4><p>Workflow collaboratif Icam</p></div></div>
      </div>
    </section>

    <section class="timeline" id="timeline">
      <h2 class="section-title">Evolution Timeline</h2>
      <div class="timeline-container">
        <div class="timeline-line"></div>
        <div class="timeline-item">
          <div class="timeline-content"><div class="timeline-year">2024</div><h4>Genesis Protocol</h4><p>Lancement du template NeuralGlass fusionn√© avec le g√©n√©rateur de propales Icam.</p></div>
          <div class="timeline-dot"></div>
        </div>
        <div class="timeline-item">
          <div class="timeline-content"><div class="timeline-year">2025</div><h4>Matrix Integration</h4><p>Ajout du backend DeepSeek & Google Drive pour une g√©n√©ration en un clic.</p></div>
          <div class="timeline-dot"></div>
        </div>
        <div class="timeline-item">
          <div class="timeline-content"><div class="timeline-year">2026</div><h4>Quantum Leap</h4><p>Console Apple-like unifi√©e, exp√©rience responsive et anim√©e.</p></div>
          <div class="timeline-dot"></div>
        </div>
        <div class="timeline-item">
          <div class="timeline-content"><div class="timeline-year">2027</div><h4>Neural Singularity</h4><p>Standardisation des propales au sein de l'√©cosyst√®me PSE avec automatisations IA.</p></div>
          <div class="timeline-dot"></div>
        </div>
      </div>
    </section>

    <section class="contact" id="contact">
      <div class="contact-container">
        <div class="contact-info">
          <h3>Establish Connection</h3>
          <p>Besoin d'it√©rations suppl√©mentaires, d'un nouveau mod√®le ou d'une extension CRM ? Contactez l'√©quipe NeuralGlass.</p>
          <p>Nous vous accompagnons pour enrichir le backend Apps Script, suivre les co√ªts DeepSeek et perfectionner vos templates Docs.</p>
          <div class="social-links">
            <a href="#">üì°</a>
            <a href="#">üåê</a>
            <a href="#">üí¨</a>
            <a href="#">üì®</a>
          </div>
        </div>
        <form class="contact-form" onsubmit="return false;">
          <div class="form-group"><label for="contact-name">Neural ID</label><input id="contact-name" type="text" placeholder="Nom"></div>
          <div class="form-group"><label for="contact-email">Quantum Channel</label><input id="contact-email" type="email" placeholder="Email"></div>
          <div class="form-group"><label for="contact-subject">Mission Objective</label><input id="contact-subject" type="text" placeholder="Sujet"></div>
          <div class="form-group"><label for="contact-message">Transmission Data</label><textarea id="contact-message" rows="4" placeholder="Votre message..."></textarea></div>
          <button type="submit" class="submit-btn">Transmit to Matrix</button>
        </form>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <div class="footer-links">
        <a href="#console">Console</a>
        <a href="#features">Neural Networks</a>
        <a href="#showcase">Matrix Protocols</a>
        <a href="#timeline">Evolution</a>
        <a href="#contact">Connect</a>
        <a href="https://github.com" target="_blank" rel="noopener">GitHub</a>
      </div>
      <div>&copy; 2025 NeuralGlass Interface ¬∑ All quantum rights reserved.</div>
      <div>Design TemplateMo ¬∑ Augmented by NeuralGlass & Icam Apps Script</div>
    </div>
  </footer>

  <div id="modal">
    <div class="modal-card">
      <div>
        <h3 id="modalTitle">G√©n√©ration en cours‚Ä¶</h3>
        <p id="modalStatus">Pr√©paration</p>
      </div>
      <div class="modal-progress"><div id="progressBar" class="modal-progress-bar"></div></div>
      <div id="modalResult" class="modal-result"></div>
      <div class="modal-actions"><button id="btnCloseModal">Fermer</button></div>
    </div>
  </div>

  <script>
    const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
    const mobileNav = document.querySelector('.mobile-nav');
    if (mobileMenuToggle && mobileNav) {
      mobileMenuToggle.addEventListener('click', () => {
        mobileMenuToggle.classList.toggle('active');
        mobileNav.classList.toggle('active');
      });
      document.querySelectorAll('.mobile-nav a').forEach(link => {
        link.addEventListener('click', () => {
          mobileMenuToggle.classList.remove('active');
          mobileNav.classList.remove('active');
        });
      });
      document.addEventListener('click', (e) => {
        if (!mobileMenuToggle.contains(e.target) && !mobileNav.contains(e.target)) {
          mobileMenuToggle.classList.remove('active');
          mobileNav.classList.remove('active');
        }
      });
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        const target = document.querySelector(targetId);
        if (target) {
          e.preventDefault();
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      });
    });

    function updateActiveMenuItem() {
      const sections = document.querySelectorAll('section[id]');
      const navLinks = document.querySelectorAll('.nav-links a, .mobile-nav a');
      let currentSection = '';
      const scrollPos = window.pageYOffset + 120;
      sections.forEach(section => {
        const top = section.offsetTop;
        const height = section.offsetHeight;
        if (scrollPos >= top && scrollPos < top + height) {
          currentSection = '#' + section.id;
        }
      });
      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === currentSection) {
          link.classList.add('active');
        }
      });
    }
    window.addEventListener('scroll', updateActiveMenuItem);
    window.addEventListener('load', updateActiveMenuItem);

    window.addEventListener('scroll', () => {
      const header = document.querySelector('header');
      if (!header) return;
      const scrolled = window.pageYOffset;
      if (scrolled > 60) { header.classList.add('scrolled'); } else { header.classList.remove('scrolled'); }
    });

    window.addEventListener('scroll', () => {
      const shapes = document.querySelectorAll('.shape');
      const scrolled = window.pageYOffset;
      shapes.forEach((shape, index) => {
        const speed = (index + 1) * 0.25;
        shape.style.transform = `translateY(${scrolled * speed}px) rotate(${scrolled * 0.08}deg)`;
      });
    });

    const neuralLines = document.querySelectorAll('.neural-line');
    if (neuralLines.length) {
      setInterval(() => {
        neuralLines.forEach((line, index) => {
          setTimeout(() => {
            line.style.animation = 'neuralPulse 1.8s ease';
            setTimeout(() => { line.style.animation = ''; }, 1800);
          }, index * 260);
        });
      }, 2200);
    }

    function createQuantumParticle() {
      const particle = document.createElement('div');
      particle.style.position = 'fixed';
      particle.style.width = Math.random() * 4 + 1 + 'px';
      particle.style.height = particle.style.width;
      const palette = ['#00ffff', '#ff0080', '#8000ff'];
      const color = palette[Math.floor(Math.random() * palette.length)];
      particle.style.background = color;
      particle.style.borderRadius = '50%';
      particle.style.left = Math.random() * 100 + '%';
      particle.style.top = '100vh';
      particle.style.pointerEvents = 'none';
      particle.style.zIndex = '-1';
      particle.style.boxShadow = `0 0 12px ${color}`;
      document.body.appendChild(particle);
      const duration = Math.random() * 3000 + 2500;
      const drift = (Math.random() - 0.5) * 200;
      particle.animate([
        { transform: 'translateY(0px) translateX(0px)', opacity: 0 },
        { transform: `translateY(-105vh) translateX(${drift}px)`, opacity: 1 }
      ], { duration, easing: 'ease-out' }).onfinish = () => particle.remove();
    }
    setInterval(createQuantumParticle, 1600);

    const observerOptions = { threshold: 0.12, rootMargin: '0px 0px -50px 0px' };
    const revealObserver = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);
    document.querySelectorAll('.timeline-content, .hexagon-inner, .feature-content').forEach(el => {
      el.style.opacity = '0';
      el.style.transform = 'translateY(40px)';
      el.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
      revealObserver.observe(el);
    });

    const contactButton = document.querySelector('.submit-btn');
    if (contactButton) {
      contactButton.addEventListener('click', function(e) {
        e.preventDefault();
        const original = this.innerHTML;
        this.innerHTML = 'Transmitting...';
        this.disabled = true;
        setTimeout(() => {
          this.innerHTML = 'Transmission Complete';
          setTimeout(() => {
            this.innerHTML = original;
            this.disabled = false;
          }, 2000);
        }, 1400);
      });
    }

    const $ = (id) => document.getElementById(id);
    const resultStatusEl = $('resultStatus');
    const resultHistoryEl = $('resultHistory');

    function updateResultPanel({ state = 'idle', message = '', link = '', linkLabel = 'Ouvrir', recordHistory = true } = {}) {
      if (resultStatusEl && message) {
        resultStatusEl.className = `result-status is-${state}`;
        resultStatusEl.innerHTML = '';
        const textSpan = document.createElement('span');
        textSpan.textContent = message;
        resultStatusEl.appendChild(textSpan);
        if (link) {
          const anchor = document.createElement('a');
          anchor.href = link;
          anchor.target = '_blank';
          anchor.rel = 'noopener';
          anchor.textContent = linkLabel || 'Ouvrir';
          resultStatusEl.appendChild(anchor);
        }
      }
      if (recordHistory && resultHistoryEl && message) {
        const placeholder = resultHistoryEl.querySelector('[data-placeholder="true"]');
        if (placeholder) placeholder.remove();
        const timestamp = new Date();
        const timeLabel = timestamp.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
        const item = document.createElement('li');
        item.className = `result-item is-${state}`;
        const span = document.createElement('span');
        span.textContent = message;
        const time = document.createElement('time');
        time.setAttribute('datetime', timestamp.toISOString());
        time.textContent = timeLabel;
        item.append(span, time);
        resultHistoryEl.prepend(item);
        const entries = resultHistoryEl.querySelectorAll('li');
        if (entries.length > 5) {
          Array.from(entries)
            .slice(5)
            .forEach((entry) => entry.remove());
        }
      }
    }
    function showModal(title, status, pct = 0) {
      $('modalTitle').textContent = title;
      $('modalStatus').textContent = status;
      $('progressBar').style.width = pct + '%';
      $('modalResult').innerHTML = '';
      $('btnCloseModal').style.display = 'none';
      $('modal').classList.add('active');
    }
    function hideModal() { $('modal').classList.remove('active'); }
    function collectForm() {
      const fields = ['titre','codeProjet','dateDebut','versionDoc','dureeProjet','thematique','entrepriseNom','entrepriseAdresse','clientNom','clientFonction','clientEmail','clientTelephone','entrepriseLogo','contexte','demarche','phases','phrase'];
      const out = {};
      fields.forEach(f => out[f] = ($('f_' + f)?.value || '').trim());
      return out;
    }
    const btnGenerate = $('btnGenerate');
    if (btnGenerate) {
      btnGenerate.addEventListener('click', () => {
        const fd = collectForm();
        if (!fd.titre || !fd.entrepriseNom) {
          alert('‚ö†Ô∏è Le titre et le nom de l\'entreprise sont obligatoires.');
          return;
        }
        showModal('üöÄ Lancement', 'Copie du mod√®le‚Ä¶', 18);
        updateResultPanel({ state: 'progress', message: 'G√©n√©ration en cours‚Ä¶', recordHistory: false });
        const runner = (typeof google !== 'undefined' && google.script && google.script.run) ? google.script.run : null;
        if (!runner) {
          setTimeout(() => {
            $('modalStatus').textContent = 'Pr√©visualisation locale (Apps Script requis).';
            $('progressBar').style.width = '100%';
            $('modalResult').innerHTML = '<p>google.script.run non disponible hors Apps Script.</p>';
            $('btnCloseModal').style.display = 'inline-flex';
            updateResultPanel({ state: 'error', message: 'Pr√©visualisation locale uniquement (Apps Script requis).', recordHistory: true });
          }, 600);
          return;
        }
        runner
          .withSuccessHandler(res => {
            if (res && res.success) {
              showModal('üéâ Succ√®s', 'Document cr√©√©', 100);
              const docUrl = res && res.url ? res.url : '';
              const successMessage = docUrl ? 'Document g√©n√©r√©' : 'Document g√©n√©r√© (URL non transmise)';
              $('modalResult').innerHTML = docUrl ? `<a href="${docUrl}" target="_blank" rel="noopener">üìÑ Ouvrir le document</a>` : '';
              updateResultPanel({ state: 'success', message: successMessage, link: docUrl, linkLabel: 'Ouvrir', recordHistory: true });
            } else {
              showModal('‚ùå Erreur', (res && res.error) || 'Erreur inconnue', 0);
              updateResultPanel({ state: 'error', message: (res && res.error) || 'Erreur inconnue', recordHistory: true });
            }
            $('btnCloseModal').style.display = 'inline-flex';
          })
          .withFailureHandler(err => {
            showModal('‚ùå Erreur', err && err.message ? err.message : String(err), 0);
            updateResultPanel({ state: 'error', message: err && err.message ? err.message : String(err), recordHistory: true });
            $('btnCloseModal').style.display = 'inline-flex';
          })
          .generateFromForm(fd);
      });
    }
    const closeBtn = $('btnCloseModal');
    if (closeBtn) {
      closeBtn.addEventListener('click', hideModal);
    }
    const modal = $('modal');
    if (modal) {
      modal.addEventListener('click', (e) => { if (e.target === modal) hideModal(); });
    }
  </script>
</body>
</html>
